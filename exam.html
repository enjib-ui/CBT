<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Halaman Ujian</title>
</head>
<body>
  <h2>ðŸ“˜ Soal Ujian</h2>
  <div id="soalContainer">Menunggu soal dari guru...</div>
  <button onclick="submitJawaban()">Kirim Jawaban</button>

  <!-- Firebase -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-app.js";
    import { getFirestore, doc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDonmsxOpPSafblXFwjZozjQjb6d_ONDG8",
      authDomain: "authfirebase-4a2ce.firebaseapp.com",
      projectId: "authfirebase-4a2ce",
      storageBucket: "authfirebase-4a2ce.firebasestorage.app",
      messagingSenderId: "395028121712",
      appId: "1:395028121712:web:8bf3d5470c13204bef8cb5"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const soalContainer = document.getElementById("soalContainer");
    let jawabanSiswa = {};

    // Dengarkan soal terbaru dari guru
    onSnapshot(doc(db, "soal", "aktif"), (docSnap) => {
      if (docSnap.exists()) {
        const data = docSnap.data();
        soalContainer.innerHTML = "";

        data.soal.forEach((row, i) => {
          const pertanyaan = row.Pertanyaan || `Soal ${i+1}`;
          const opsiA = row.A || "A";
          const opsiB = row.B || "B";
          const opsiC = row.C || "C";
          const opsiD = row.D || "D";

          soalContainer.innerHTML += `
            <div style="margin-bottom:10px;">
              <p><b>${i+1}.</b> ${pertanyaan}</p>
              <label><input type="radio" name="soal${i}" value="A"> A. ${opsiA}</label><br>
              <label><input type="radio" name="soal${i}" value="B"> B. ${opsiB}</label><br>
              <label><input type="radio" name="soal${i}" value="C"> C. ${opsiC}</label><br>
              <label><input type="radio" name="soal${i}" value="D"> D. ${opsiD}</label>
            </div>
          `;
        });
      } else {
        soalContainer.innerHTML = "Belum ada soal dari guru.";
      }
    });

    // Kumpulkan jawaban
    window.submitJawaban = function() {
      const inputs = document.querySelectorAll("input[type=radio]:checked");
      inputs.forEach(inp => {
        jawabanSiswa[inp.name] = inp.value;
      });
      alert("Jawaban dikumpulkan (sementara hanya di browser): " + JSON.stringify(jawabanSiswa));
    };
  </script>
</body>
</html>